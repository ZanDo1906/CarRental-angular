<main class="main-content">
    <div class="content-item user-profile">
        <div class="title">
            <div class="title-edit">
                <h5>Thông tin tài khoản</h5>
                <i class="bi bi-pencil" (click)="onEdit('profile')" style="cursor:pointer"></i>
                <div class="ms-2 d-inline-block">
                    <button *ngIf="editingProfile" class="btn1 btn--s btn-save" (click)="saveUser()">Lưu</button>
                    <button *ngIf="editingProfile" class="btn1 btn--s btn-cancel" (click)="cancelEdit()">Hủy</button>
                </div>
            </div>
            <div class="total-trips" style="align-items: center;">
                <i class="bi bi-car-front-fill" style="font-size: 20px;" ></i>
                <p class="count" (click)="refreshTripsCount()" style="cursor: pointer;" title="Click để refresh">{{
                    totalTripsCount }}</p>
                <span>Chuyến</span>
            </div>
        </div>
        <div class="content">
            <div class="avatar-box">
                <label class="avatar avatar--xl has-edit" for="avatarInput"
                    style="cursor: pointer; position: relative;">
                    <img [src]="avatarUrl" [alt]="user?.Ho_va_ten || 'avatar'"
                        style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;"
                        (error)="$any($event.target).src='/assets/images/user_avt.jpg'">
                    <div class="avatar-edit-overlay">
                        <i class="bi bi-camera" style="color: aliceblue; font-size: 24px; text-align: center;"></i>
                    </div>
                </label>
                <input id="avatarInput" type="file" accept="image/*" style="display:none"
                    (change)="onAvatarSelected($event)">
                <h6>{{ user?.Ho_va_ten || 'Tên người dùng' }}</h6>
                <p class="note">Tham gia {{ user?.Ngay_tao || '' }}</p>
            </div>
            <div class="info-user">
                <div class="info-desc">
                    <div class="info-desc__item">
                        <div class="title-item">
                            Ngày sinh
                        </div>
                        <div class="name pointer">
                            <ng-container *ngIf="!editingProfile">
                                <p>{{ user?.Ngay_sinh ? (user.Ngay_sinh | date:'yyyy-MM-dd') : 'Chưa cập nhật' }}</p>
                            </ng-container>
                            <ng-container *ngIf="editingProfile">
                                <input type="date" [(ngModel)]="user.Ngay_sinh">
                            </ng-container>
                        </div>
                    </div>
                    <div class="info-desc__item">
                        <div class="title-item">
                            Giới tính
                        </div>
                        <div class="name pointer">
                            <ng-container *ngIf="!editingProfile">
                                <p>{{ user?.Gioi_tinh || 'Nữ' }}</p>
                            </ng-container>
                            <ng-container *ngIf="editingProfile">
                                <select [(ngModel)]="user.Gioi_tinh">
                                    <option value="Nữ">Nữ</option>
                                    <option value="Nam">Nam</option>
                                    <option value="Khác">Khác</option>
                                </select>
                            </ng-container>
                            <div class="wrap-svg"></div>
                        </div>
                    </div>
                    <div class="info-desc__item">
                        <div class="title-item">
                            Số điện thoại
                        </div>
                        <div class="name pointer">
                            {{ user?.So_dien_thoai || 'Chưa có số điện thoại' }}
                            <div class="wrap-svg"></div>
                        </div>
                    </div>
                    <div class="info-desc__item">
                        <div class="title-item">
                            Email

                        </div>
                        <div class="name pointer">
                            {{ user?.Email || 'Chưa có email' }}
                            <div class="wrap-svg"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="content-item driver-license">
        <div class="title">
            <div class="title-item">
                <h6>Giấy phép lái xe</h6>
                <div class="title-item__info error">
                    <i class="bi bi-exclamation-circle-fill" style="color: #f04438; font-size: 20px;"></i>
                    Chưa xác thực
                </div>
            </div>
            <div>
                <button *ngIf="!editingLicense" class="btn1 btn--s" (click)="onEdit('license')">Chỉnh sửa
                    <div class="wrap-svg" (click)="onEdit('profile')" style="cursor:pointer">
                        <i class="bi bi-pencil"></i>
                    </div>
                </button>
                <button *ngIf="editingLicense" class="btn1 btn--s btn-save" (click)="saveLicense()">Lưu</button>
                <button *ngIf="editingLicense" class="btn1 btn--s btn-cancel" (click)="cancelLicenseEdit()">Hủy</button>
                <!-- <button class="btn1 btn--s ms-2" (click)="onEdit('uploadGPLX')" [disabled]="user?._licenseAuthenticated">Tải lên ảnh GPLX</button> -->
            </div>

        </div>
        <div class="note-license">
            <p>
                <b>Lưu ý</b>: để tránh phát sinh vấn đề trong quá trình thuê xe, <u>người đặt xe</u>
                trên Mioto (đã
                xác thực GPLX) <b>ĐỒNG THỜI</b> phải là <u>người nhận xe</u>.
            </p>
        </div>
        <div class="learn-more">
            <p class="text-disabled">
                Bạn có thể sử dụng GPLX thẻ cứng hoặc GPLX điện tử trên VNeID
            </p>
            <div class="wrap-svg"></div>
        </div>
        <div class="content">
            <div class="info-license position-relative">
                <div class="info-license__title">
                    <p>Hình ảnh</p>
                </div>
                <label class="info-license__img" for="licenseInput">
                    <div class="fix-img">
                        <img [src]="user?._license || user?.Giay_phep_lai_xe || '/assets/assets/nopicture.jpg'"
                            alt="GPLX">
                    </div>
                </label>
                <!-- hidden file input for uploading license image -->
                <input id="licenseInput" type="file" accept="image/*" style="display:none"
                    (change)="onLicenseSelected($event)">
            </div>
            <div class="info-license">
                <div class="info-license__title">
                    <p>Thông tin chung</p>
                </div>
                <div class="custom-input">
                    <div class="wrap-info">
                        <div class="title-status">
                            <p>Số GPLX</p>
                        </div>
                        <div class="desc text-success"></div>
                    </div>
                    <div class="wrap-input" [ngClass]="{ 'disabled': !editingLicense }">
                        <div class="wrap-text">
                            <input [disabled]="!editingLicense" type="text" name="licenseNumber"
                                [(ngModel)]="user.Can_cuoc_cong_dan" placeholder="Nhập số GPLX đã cấp ">
                        </div>
                    </div>
                </div>
                <div class="custom-input">
                    <div class="wrap-info">
                        <div class="title-status">
                            <p>Họ và tên</p>
                        </div>
                        <div class="desc text-success"></div>
                    </div>
                    <div class="wrap-input" [ngClass]="{ 'disabled': !editingLicense }">
                        <div class="wrap-text">
                            <input [disabled]="!editingLicense" type="text" name="licenseName"
                                [(ngModel)]="user.Ho_va_ten" placeholder="Nhập đầy đủ họ tên ">
                        </div>
                    </div>
                </div>
                <div class="custom-input">
                    <div class="wrap-info">
                        <div class="title-status">
                            <p>Ngày sinh</p>
                        </div>
                        <div class="desc text-success"></div>
                    </div>
                    <div class="wrap-input" [ngClass]="{ 'disabled': !editingLicense }">
                        <div class="wrap-text">
                            <input [disabled]="!editingLicense" type="text" name="licenseBirth"
                                [(ngModel)]="user.Ngay_sinh" placeholder="Nhập ngày sinh ">
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="learn-more"></div>
    </div>
</main>